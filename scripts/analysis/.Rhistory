getwd()
bam_depth <- read.table("../data/ancillary/bam_depth.txt", header=T, quote="\"")
getwd(0)
getwd()
bam_depth <- read.table("../../data/ancillary/bam_depth.txt", header=T, quote="\"")
dir(../)
dir("../"
)
dir("../../")
dir("../../data")
dir("../../data/ancillary/")
bam_depth <- read.table("../../data/ancillary/bam_depth.txt", header=T, quote="\"")
dir()
dir("../../data/ancillary/")
bam_depth <- read.table("../../data/ancillary/bam_depth.txt", header=T, quote="\"")
View(bam_depth)
vars <- c("Run","Library","Strain","junk")
bam_depth[,vars] <- colsplit(bam_depth$bam, "-|-", vars)
bam_depth$junk <- NULL
View(bam_depth)
fastq_info <- read.csv("../../data/ancillary/fastq_info.csv")
fastq_info <- read.csv("../../data/ancillary/fastq_info.txt")
View(fastq_info)
fastq_info[,vars] <- colsplit(fastq_info$fastq, "-|-", vars)
View(fastq_info)
vars <- c("Run","Library","Strain","hash1", "hash2")
fastq_info[,vars] <- colsplit(fastq_info$fastq, "-|-", vars)
vars <- c("Run","Library","Strain","hash", "ext")
fastq_info[,vars] <- colsplit(fastq_info$fastq, "-|-", vars)
fastq_info <- read.csv("../../data/ancillary/fastq_info.txt")
vars <- c("Run","Library","Strain","hash", "ext")
fastq_info[,vars] <- colsplit(fastq_info$fastq, "-|-", vars)
View(fastq_info)
fastq_info <- tbl_df(fastq_info)
View(fastq_info)
groupby(fastq_info,hash)
group_by(fastq_info,hash)
group_by(fastq_info,run, library, strain)
mutate(bam=mean(lane))
group_by(fastq_info,run, library, strain) %.%
mutate(bam=mean(lane))
x <- group_by(fastq_info,run, library, strain) %.%
mutate(bam=mean(lane))
View(x)
split(fastq_info, run,library,strain)
split(fastq_info, "run","library")
split(fastq_info, "run","library","strain")
?group_by
vignette("introduction", package = "dplyr")
levels(bam_depth)
levels(bam_depth$bam)
levels(fastq_info$fastq)
levelsof(fastq_info$fastq)
unique(fastq_info$fastq)
x <- group_by(fastq_info,run, library, strain) %.%
mutate(bam=unique(fastq_info$hash))
mutate(bam=c(unique(fastq_info$hash))
View(x)
View(x)
x <- group_by(fastq_info,run, library, strain) %.%
mutate(bam=c(unique(fastq_info$hash))
)
x <- group_by(fastq_info,run, library, strain) %.%
mutate(bam=paste0(unique(fastq_info$hash)))
unique(fastq_info$hash)
paste0(unique(fastq_info$hash))
paste(unique(fastq_info$hash))
paste(unique(fastq_info$hash), collapse="-")
x <- group_by(fastq_info,run, library, strain) %.%
mutate(bam=paste0(unique(fastq_info$hash), collapse='-'))
View(x)
group_by(fastq_info,run, library, strain)
group_by(fastq_info,run, library, strain) %.% mutate(bam=paste0(unique(fastq_info$hash), collapse="-"))
View(x)
x <- group_by(fastq_info,run, library, strain) %.%
mutate(bam=paste0(unique(hash), collapse='-'))
View(x)
x <- group_by(fastq_info,run, library, strain, flowcell) %.%
mutate(bam=paste0(unique(hash), collapse='-'))
View(x)
x <- group_by(fastq_info,run, library, strain, flowcell, lane) %.%
mutate(bam=paste0(unique(hash), collapse='-'))
x <- group_by(fastq_info,run, library, strain, flowcell, lane) %.%
mutate(bam=paste0(unique(hash), collapse='-'))
View(x)
x <- group_by(fastq_info,run, library, strain, flowcell, lane) %.%
mutate(bam=paste0(run,unique(hash), collapse='-'))
View(x)
x <- group_by(fastq_info,run, library, strain, flowcell, lane) %.%
mutate(bam=sprintf("%s-%s-%s-%s", run, library, strain, paste0(unique(hash), collapse='-')))
View(x)
fastq_info <- read.csv("../../data/ancillary/fastq_info.txt",  strip.white = T)
vars <- c("Run","Library","Strain","hash", "ext")
fastq_info[,vars] <- colsplit(fastq_info$fastq, "-|-", vars)
fastq_info <- tbl_df(fastq_info)
x <- group_by(fastq_info,run, library, strain, flowcell, lane) %.%
mutate(bam=sprintf("%s-%s-%s-%s", run, library, strain, paste0(unique(hash), collapse='-')))
View(x)
bam_depth <- read.table("../../data/ancillary/bam_depth.txt", header=T, quote="\"",  strip.white = T)
View(bam_depth)
vars <- c("Run","Library","Strain","junk")
bam_depth[,vars] <- colsplit(bam_depth$bam, "-|-", vars)
bam_depth$junk <- NULL
# Construct bam filename
fastq_info <- read.csv("../../data/ancillary/fastq_info.txt",  strip.white = T)
vars <- c("Run","Library","Strain","hash", "ext")
fastq_info[,vars] <- colsplit(fastq_info$fastq, "-|-", vars)
fastq_info <- tbl_df(fastq_info)
x <- group_by(fastq_info,run, library, strain, flowcell, lane) %.%
mutate(bam=sprintf("%s-%s-%s-%s.bam", run, library, strain, paste0(unique(hash), collapse='-')))
View(x)
unique(fastq_info[c("bam","lane")])
unique(fastq_info[,c("bam","lane")])
?filter
x <- group_by(fastq_info,run, library, strain, flowcell, lane) %.%
mutate(bam=sprintf("%s-%s-%s-%s.bam", run, library, strain, paste0(unique(hash), collapse='-'))) %.%
filter(pair=1)
group_by(fastq_info,run, library, strain, flowcell, lane) %.%
mutate(bam=sprintf("%s-%s-%s-%s.bam", run, library, strain, paste0(unique(hash), collapse='-'))) %.%
filter(pair=1)
filter(pair==1)
x <- group_by(fastq_info,run, library, strain, flowcell, lane) %.%
mutate(bam=sprintf("%s-%s-%s-%s.bam", run, library, strain, paste0(unique(hash), collapse='-'))) %.%
filter(pair==1)
View(x)
?arrange()
x <- group_by(fastq_info,run, library, strain, flowcell, lane) %.%
mutate(bam=sprintf("%s-%s-%s-%s.bam", run, library, strain, paste0(unique(hash), collapse='-'))) %.%
filter(pair==1) %.%
select(bam, lane, flowcell)
x <- group_by(fastq_info,run, library, strain, flowcell, lane) %.%
mutate(bam=sprintf("%s-%s-%s-%s.bam", run, library, strain, paste0(unique(hash), collapse='-'))) %.%
filter(pair==1) %.%
ungroup() %.%
select(bam, lane, flowcell)
View(x)
fastq_info <- read.csv("../../data/ancillary/fastq_info.txt",  strip.white = T)
vars <- c("Run","Library","Strain","hash", "ext")
fastq_info[,vars] <- colsplit(fastq_info$fastq, "-|-", vars)
fastq_info <- group_by(fastq_info,run, library, strain, flowcell, lane) %.%
mutate(bam=sprintf("%s-%s-%s-%s.bam", run, library, strain, paste0(unique(hash), collapse='-'))) %.%
filter(pair==1) %.%
ungroup() %.%
select(bam, lane, flowcell)
rm(x)
View(bam_depth)
?join
inner_join(fastq_info, bam_depth, by = bam)
inner_join(fastq_info, bam_depth, by = 'bam')
j <- inner_join(fastq_info, bam_depth, by = 'bam')
View(j)
summarise(j$avg_depth)
summary(j$avg_depth)
d <- inner_join(fastq_info, bam_depth, by = 'bam')
qplot(depth,data=d)
?ggplot
ggplot(data=d)
ggplot(data=d, aes(y=depth)) +
ggplot(data=d, aes(y=depth))
ggplot(data=d, aes(y=depth))
ggplot(data=d, aes(y=depth, library)) +
geom_point()
ggplot(data=d, aes(y=depth, x=library)) +
geom_point()
ggplot(data=d, aes(y=depth, x='library')) +
geom_point()
ggplot(data=d, aes(y='depth', x='library')) +
geom_point()
ggplot(data=d, aes(y=depth, x='library')) +
geom_point()
ggplot(data=d, aes(y=avg_depth, x='library')) +
geom_point()
ggplot(data=d, aes(x=avg_depth, y='library')) +
geom_point()
ggplot(data=d, aes(x=avg_depth, y=library)) +
geom_point()
ggplot(data=d, aes(x=avg_depth, y='library')) +
coord_flip() +
geom_point()
ggplot(data=d, aes(y=avg_depth, x='library')) +
coord_flip() +
geom_point()
ggplot(data=d, aes(y=avg_depth)) +
coord_flip() +
geom_point() +
()
ggplot(data=d, aes(y=avg_depth)) +
coord_flip() +
geom_point()
ggplot(data=d, aes(y=avg_depth)) +
coord_flip() +
geom_point()
ggplot(data=d, aes(y=avg_depth)) +
coord_flip() +
geom_point() +
facet_grid(library ~ ., scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth, x=library)) +
coord_flip() +
geom_point() +
facet_grid(library ~ ., scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth, x=library)) +
coord_flip() +
geom_point() +
facet_grid(. ~ library, scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth, x=library)) +
coord_flip() +
geom_point() +
facet_grid(library, scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth, x='library')) +
coord_flip() +
geom_point() +
facet_grid('library', scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth, x='library')) +
coord_flip() +
geom_point()
facet_grid(avg_depth ~ 'library', scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth, x='library')) +
coord_flip() +
geom_point()
facet_grid(avg_depth ~ 'library', scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth, x='library')) +
coord_flip() +
geom_point()
facet_grid(. ~ 'library', scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth, x='library')) +
coord_flip() +
geom_point()
facet_grid(run ~ ., scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth, x='library')) +
coord_flip() +
geom_point()
facet_grid(run ~ avg_depth, scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth, x='run')) +
coord_flip() +
geom_point()
facet_grid(run ~ avg_depth, scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth, x='run')) +
coord_flip() +
geom_point()
facet_grid(run ~ ., scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth, x='run')) +
coord_flip() +
geom_point()
facet_grid(d$run ~ ., scales = "free", space = "free")
ggplot(data=d, aes(avg_depth, run)) +
coord_flip() +
geom_point()
facet_grid(run ~ ., scales = "free", space = "free")
ggplot(data=d, aes(avg_depth, Run)) +
coord_flip() +
geom_point()
facet_grid(Run ~ ., scales = "free", space = "free")
ggplot(data=d, aes(avg_depth, Run)) +
geom_point() +
facet_grid(Run ~ ., scales = "free", space = "free") +
coord_flip()
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_point() +
facet_grid(Run ~ ., scales = "free", space = "free") +
coord_flip()
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_point() +
coord_flip() +
facet_grid(Run ~ ., scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth)) +
geom_point() +
coord_flip() +
facet_grid(Run ~ ., scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_point() +
coord_flip() +
facet_grid('flowcell' ~ ., scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_point() +
coord_flip() +
facet_grid(lane ~ ., scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_point() +
coord_flip() +
facet_grid(lane ~ Run, scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_point() +
coord_flip() +
facet_grid(lane ~, scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_point() +
coord_flip() +
facet_grid(c(lane, Run) ~ ., scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_point() +
coord_flip() +
facet_grid(lane ~ ., scales = "free", space = "free")  +
facet_grid(flowcell ~ ., scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_point() +
coord_flip() +
facet_grid(lane ~ flowcell, scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth)) +
geom_point() +
coord_flip() +
facet_grid(lane ~ flowcell, scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth)) +
geom_histogram()
ggplot(data=d, aes(x=avg_depth)) +
geom_histogram()
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_boxplot()
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_boxplot() +
coord_flip() +
()
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_boxplot() +
coord_flip()
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_boxplot() +
coord_flip() +
facet_grid('library' ~ ., scales = "free", space = "free")
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_boxplot() +
coord_flip() +
facet_grid('library' ~ .)
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_boxplot() +
coord_flip() +
facet_grid(library ~ .)
d$lib <- d$library
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_boxplot() +
coord_flip() +
facet_grid(lib~ .)
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_boxplot() +
coord_flip() +
facet_grid(lib ~ .)
d$lib <- d$Library
d <- rename(d,c("Library"="lib"))
fastq_info <- group_by(fastq_info,run, library, strain, flowcell, lane) %.%
mutate(bam=sprintf("%s-%s-%s-%s.bam", run, library, strain, paste0(unique(hash), collapse='-'))) %.%
filter(pair==1) %.%
ungroup() %.%
select(bam, lane, flowcell)
d <- inner_join(fastq_info, bam_depth, by = 'bam')
d <- rename(d,c("Library"="lib"))
ggplot(data=d, aes(y=avg_depth,x=Run)) +
geom_boxplot() +
coord_flip() +
facet_grid(lib ~ .)
ggplot(data=d, aes(y=avg_depth,x=lib)) +
geom_boxplot() +
coord_flip() +
facet_grid(Run ~ .)
ggplot(data=d, aes(y=avg_depth,x=lib), order=reverse()) +
geom_boxplot() +
coord_flip() +
facet_grid(Run ~ .)
ggplot(data=d, aes(y=avg_depth,x=lib, order=desc(lib))) +
geom_boxplot() +
coord_flip() +
facet_grid(Run ~ .)
ggplot(data=d, aes(y=avg_depth,x=lib, order=asc(lib))) +
geom_boxplot() +
coord_flip() +
facet_grid(Run ~ .)
ggplot(data=d, aes(y=avg_depth,x=lib, order=asc(lib))) +
geom_boxplot() +
coord_flip() +
facet_grid(Run ~ .)
ggplot(data=d, aes(y=avg_depth,x=lib, order=-desc(lib))) +
geom_boxplot() +
coord_flip() +
facet_grid(Run ~ .)
